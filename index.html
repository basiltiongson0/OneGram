<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Instagram Profile</title>
</head>
<body>
   <div class="container">
       <div class="profile-header">
           <div class="profile-pic"></div>
           <div class="profile-info">
               <div class="username">username</div>
               <div class="profile-actions">
                   <button class="follow-btn">Follow</button>
                   <button class="edit-btn" onclick="toggleEditPanel()">Edit Profile</button>
               </div>
               <div class="stats">
                   <div class="stat"><span class="stat-number">123</span> posts</div>
                   <div class="stat"><span class="stat-number">1.2K</span> followers</div>
                   <div class="stat"><span class="stat-number">500</span> following</div>
               </div>
               <div class="bio">
                   Display Name<br>
                   Bio text goes here<br>
                   category/genre<br>
                   <a href="#">website.com</a>
               </div>
           </div>
       </div>


       <div class="content-tabs">
           <div class="tab active">POSTS</div>
           <div class="tab">REELS</div>
           <div class="tab">TAGGED</div>
       </div>


       <div class="grid">
           <div class="grid-item"></div>
           <div class="grid-item"></div>
           <div class="grid-item"></div>
           <div class="grid-item"></div>
           <div class="grid-item"></div>
           <div class="grid-item"></div>
       </div>
   </div>


   <!-- the edit panel -->
   <div class="edit-panel" id="editPanel">
       <!-- main edit menu -->
       <div class="panel-content" id="mainMenu">
           <div class="edit-panel-header">
               <h2>Edit Profile</h2>
               <button class="close-btn" onclick="toggleEditPanel()">×</button>
           </div>
           <div class="options-list">
               <div class="option-item" onclick="openSubmenu('presetsMenu')">
                   <div class="option-name">Profile Themes</div>
                   <div class="option-description">Change the visual display of your profile</div>
               </div>
               <div class="option-item">
                   <div class="option-name">Grid Sizing</div>
                   <div class="option-description">Update the size and display of your Instagram grid</div>
               </div>
               <div class="option-item">
                   <div class="option-name">Communities</div>
                   <div class="option-description">Create or manage a Community</div>
               </div>
           </div>
       </div>


       <!-- submenu for the color presets -->
       <div class="panel-content submenu" id="presetsMenu">
           <div class="edit-panel-header">
               <button class="back-btn" onclick="closeSubmenu('presetsMenu')">←</button>
               <h2>Color Presets</h2>
               <button class="close-btn" onclick="toggleEditPanel()">×</button>
           </div>
           <div class="scroll-container">
               <div class="color-presets">
               <div class="color-preset" onclick="setTheme('minimal')" data-theme="minimal">
                   <div class="preset-preview minimal"></div>
                   <div class="preset-title">Minimal</div>
                   <div class="preset-desc">Clean and Default</div>
               </div>
           <div class="color-preset" onclick="setTheme('vibrant')">
               <div class="preset-preview vibrant"></div>
               <div class="preset-title">Citrus</div>
               <div class="preset-desc">Vibrant and Energetic</div>
           </div>
           <div class="color-preset" onclick="setTheme('professional')">
               <div class="preset-preview professional"></div>
               <div class="preset-title">Professional</div>
               <div class="preset-desc">Clear and Clean</div>
           </div>
           <div class="color-preset" onclick="setTheme('space')">
               <div class="preset-preview space"></div>
               <div class="preset-title">Space</div>
               <div class="preset-desc">Shooting Star</div>
           </div>
           <div class="color-preset custom-colors">
               <div class="preset-preview custom">
                   <div class="control-group">
                       <label for="bg-color">Background:</label>
                       <input id="bg-color">
                   </div>
                   <div class="control-group">
                       <label for="text-color">Text:</label>
                       <input id="text-color">
                   </div>
               </div>
               <div class="preset-title">Custom Colors</div>
               <div class="preset-desc">Create your own color scheme</div>
               <button class = 'saveButton' onclick=saveNewTheme()>Save</button>
           </div>
       </div>


       <div class="section-header">
           <h3>Profile Photo Frames</h3>
       </div>
       <div class="frame-presets">
           <div class="frame-option" onclick="setProfileFrame('circle')" data-frame="circle">
               <div class="frame-preview circle"></div>
               <div class="preset-title">Circle</div>
               <div class="preset-desc">Classic round frame</div>
           </div>
           <div class="frame-option" onclick="setProfileFrame('square')" data-frame="square">
               <div class="frame-preview square"></div>
               <div class="preset-title">Square</div>
               <div class="preset-desc">Modern square look</div>
           </div>
       </div>
   </div>


   <script>
        function get_user_id(){
            return "user_123";
        }

        async function pullSettings(){
            let response = await fetch(`http://127.0.0.1:5000/get-settings?userID=${get_user_id()}`,{
                method:'GET',
                mode:"cors",
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                }
            })
            let data = await response.json();

            setTheme(data['theme'])
            setGrid(data['grid'])

        }
        pullSettings();

        async function save_settings(){
            let settings = {
                "theme":theme,
                "grid":grid
            };

            let response = await fetch('http://127.0.0.1:5000/save_settings',{
                method:'POST',
                headers: {'Content-Type': 'application/json' },
                body: JSON.stringify(newTheme)
            }
            );
        }

        async function saveNewTheme(){
            let bgColor = document.getElementById("bg-color").value;
            let textColor = document.getElementById("text-color").value;
            updateCustomColors(bgColor,textColor);

            let newTheme = {
                "backgroundColor": document.documentElement.style.getPropertyValue('--background-color'),
                "headerGradient": document.documentElement.style.getPropertyValue('--header-gradient'),
               "textColor":document.documentElement.style.getPropertyValue('--text-color'),
                "secondaryText": document.documentElement.style.getPropertyValue('--secondary-text'),
                "buttonColor":document.documentElement.style.getPropertyValue('--button-color'),
                "buttonHover": document.documentElement.style.getPropertyValue('--button-hover'),
                "borderColor": document.documentElement.style.getPropertyValue('--border-color'),
                "gridBackground": document.documentElement.style.getPropertyValue('--grid-background'),
                "profile_pic_bg": document.documentElement.style.getPropertyValue('--profile-pic-bg'),
                "userID":get_user_id()
            };

            let response = await fetch('http://127.0.0.1:5000/save-theme',{
                method:'POST',
                headers: {'Content-Type': 'application/json' },
                body: JSON.stringify(newTheme)
            }
            );

            save_settings();
            // console.log("SAVE THEME");
        }
        
        async function pull_Theme(){
            let response = await fetch(`http://127.0.0.1:5000/get-theme?userID=${get_user_id()}`,{
                method:'GET',
                mode:"cors",
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                }
            })
            let data = await response.json();
            // console.log(data);

            document.documentElement.style.setProperty('--background-color', data['backgroundColor']);
            document.documentElement.style.setProperty('--text-color', data['textColor']);
            // Update other related colors
            document.documentElement.style.setProperty('--secondary-text',data['secondaryText']);
            document.documentElement.style.setProperty('--border-color', data['borderColor']);
            document.documentElement.style.setProperty('--grid-background', data['gridBackground']);
            document.documentElement.style.setProperty('--profile-pic-bg', data['profile_pic_bg']);

        }

        function setGrid(gridNum){
            switch(Number(gridNum)){
                case 0:
                    grid = nuom;
                case 1:adjustColor;
                case 2:;
            }
        }

        // pull_Theme();
       function toggleEditPanel() {
           const panel = document.getElementById('editPanel');
           panel.classList.toggle('open');
          
           // takes you back to the main menu when you close
           if (!panel.classList.contains('open')) {
               closeSubmenu('presetsMenu');
           }
       }


       function openSubmenu(menuId) {
           const submenu = document.getElementById(menuId);
           submenu.classList.add('open');
       }


       function closeSubmenu(menuId) {
           const submenu = document.getElementById(menuId);
           submenu.classList.remove('open');
       }


       function setTheme(theme) {
           // take off all existing theme classes
           document.body.classList.remove('theme-minimal', 'theme-vibrant', 'theme-professional', 'theme-space');
          
           // add a new theme class if it's not minimal (bc minimal is default)
           if (theme !== 'minimal') {
               document.body.classList.add('theme-' + theme);
           }
          
           // this shows visually that a selection was made
           const presets = document.querySelectorAll('.color-preset');
           presets.forEach(preset => {
               preset.style.border = '1px solid var(--border-color)';
           });
          
           const selectedPreset = document.querySelector(`.color-preset[data-theme="${theme}"]`);
           if (selectedPreset) {
               selectedPreset.style.border = '2px solid var(--button-color)';
           }
       }


       function setProfileFrame(frameType) {
           // remove all existing frame classes
           const profilePic = document.querySelector('.profile-pic');
           const allFrameTypes = ['circle', 'square'];
          
           allFrameTypes.forEach(type => {
               profilePic.classList.remove(`frame-${type}`);
           });
          
           // add new frame class
           profilePic.classList.add(`frame-${frameType}`);
          
           // update the selection
           const frames = document.querySelectorAll('.frame-option');
           frames.forEach(frame => {
               frame.style.border = '1px solid var(--border-color)';
           });
          
           const selectedFrame = document.querySelector(`.frame-option[data-frame="${frameType}"]`);
           if (selectedFrame) {
               selectedFrame.style.border = '2px solid var(--button-color)';
           }
       }


    function updateCustomColors(bgColor,textColor) {
    document.documentElement.style.setProperty('--background-color', bgColor);
    document.documentElement.style.setProperty('--text-color', textColor);
    //    // Update other related colors
    document.documentElement.style.setProperty('--secondary-text', adjustColor(textColor, 0.6));
    document.documentElement.style.setProperty('--border-color', adjustColor(textColor, 0.2));
    document.documentElement.style.setProperty('--grid-background', adjustColor(bgColor, 0.95));
    document.documentElement.style.setProperty('--profile-pic-bg', adjustColor(bgColor, 0.9));
    // Remove any active theme classes
    document.body.classList.remove('theme-minimal', 'theme-vibrant', 'theme-professional', 'theme-space');
    }

    function adjustColor(color, opacity) {
   const r = parseInt(color.substr(1,2), 16);
   const g = parseInt(color.substr(3,2), 16);
   const b = parseInt(color.substr(5,2), 16);
   return `rgba(${r}, ${g}, ${b}, ${opacity})`;
}



// Modify the existing setTheme function to reset custom colors when selecting a preset
function setTheme(theme) {
   // Reset custom color inputs to defaults when selecting a preset
   if(theme=='custom'){
    pull_Theme();
   }
   if (theme !== 'custom') {
       document.getElementById('bg-color').value = '#fafafa';
       document.getElementById('text-color').value = '#262626';
   
  
   // Rest of the existing setTheme function...
   document.body.classList.remove('theme-minimal', 'theme-vibrant', 'theme-professional', 'theme-space');
   if (theme !== 'minimal') {
       document.body.classList.add('theme-' + theme);
   }
  
   const presets = document.querySelectorAll('.color-preset');
   presets.forEach(preset => {
       preset.style.border = '1px solid var(--border-color)';
   });
  
   const selectedPreset = document.querySelector(`.color-preset[data-theme="${theme}"]`);
   if (selectedPreset) {
       selectedPreset.style.border = '2px solid var(--button-color)';
   }
}
}
   </script>


   <style>
   * {
       margin: 0;
       padding: 0;
       box-sizing: border-box;
       font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
   }


   /* default theme */
   :root {
       --background-color: #fafafa;
       --header-gradient: linear-gradient(to right, #ffffff, #f5f5f5);
       --text-color: #262626;
       --secondary-text: #8e8e8e;
       --button-color: #0095f6;
       --button-hover: #0081d6;
       --border-color: #dbdbdb;
       --grid-background: #efefef;
       --profile-pic-bg: #efefef;
   }


   /* these are the theme classes */
   .theme-vibrant {
       --background-color: #fff0f0;
       --header-gradient: linear-gradient(to right, #ff9a9e, #fad0c4);
       --text-color: #d4145a;
       --secondary-text: #ff6b6b;
       --button-color: #ff4b7d;
       --button-hover: #ff1a5e;
       --border-color: #ffc2c2;
       --grid-background: #ffe5e5;
       --profile-pic-bg: #ffccd5;
   }


   .theme-professional {
       --background-color: #f0f7ff;
       --header-gradient: linear-gradient(to right, #2193b0, #6dd5ed);
       --text-color: #1a365d;
       --secondary-text: #2c5282;
       --button-color: #2b6cb0;
       --button-hover: #2c5282;
       --border-color: #bee3f8;
       --grid-background: #ebf8ff;
       --profile-pic-bg: #bee3f8;
   }


   .theme-space {
       --background-color: #f8f9fa;
       --header-gradient: linear-gradient(to right, #231942, #5e548e);
       --text-color: #bbb0d8;
       --secondary-text: #5e548e;
       --button-color: #9f86c0;
       --button-hover: #5e548e;
       --border-color: #e0b1cb;
       --grid-background: #f8f9fa;
       --profile-pic-bg: #be95c4;
   }


   /* end of theme classes */


   body {
       background-color: var(--background-color);
       transition: background-color 0.3s ease;
   }


   .container {
       max-width: 935px;
       margin: 0 auto;
       padding: 30px 20px;
   }


   .profile-header {
       display: flex;
       gap: 80px;
       margin-bottom: 44px;
       background: var(--header-gradient);
       padding: 40px;
       border-radius: 12px;
       transition: background 0.3s ease;
   }


   .profile-pic {
       width: 150px;
       height: 150px;
       border-radius: 50%;
       background-color: var(--profile-pic-bg);
       flex-shrink: 0;
       transition: background-color 0.3s ease;
   }


   .profile-info {
       flex-grow: 1;
   }


   .profile-actions {
       display: flex;
       gap: 20px;
       align-items: center;
       margin: 20px 0;
   }


   .username {
       font-size: 28px;
       font-weight: 300;
       margin-bottom: 20px;
       color: var(--text-color);
       transition: color 0.3s ease;
   }


   .follow-btn {
       background-color: var(--button-color);
       color: white;
       border: none;
       padding: 5px 24px;
       border-radius: 4px;
       font-weight: 600;
       cursor: pointer;
       transition: background-color 0.3s ease;
   }


   .follow-btn:hover {
       background-color: var(--button-hover);
   }


   .edit-btn {
       background-color: transparent;
       border: 1px solid var(--border-color);
       color: var(--text-color);
       padding: 5px 24px;
       border-radius: 4px;
       font-weight: 600;
       cursor: pointer;
       transition: all 0.3s ease;
   }


   .edit-btn:hover {
       background-color: var(--background-color);
   }


   .stats {
       display: flex;
       gap: 40px;
       margin-bottom: 20px;
       color: var(--text-color);
       transition: color 0.3s ease;
   }


   .stat-number {
       font-weight: 600;
   }


   .bio {
       font-size: 16px;
       line-height: 1.5;
       color: var(--text-color);
       transition: color 0.3s ease;
   }


   .bio a {
       color: var(--button-color);
       text-decoration: none;
       transition: color 0.3s ease;
   }


   .content-tabs {
       display: flex;
       justify-content: center;
       border-top: 1px solid var(--border-color);
       margin-top: 40px;
       transition: border-color 0.3s ease;
   }


   .tab {
       padding: 20px;
       text-transform: uppercase;
       font-size: 12px;
       font-weight: 600;
       color: var(--secondary-text);
       cursor: pointer;
       letter-spacing: 1px;
       transition: color 0.3s ease;
   }


   .tab.active {
       color: var(--text-color);
       border-top: 1px solid var(--text-color);
       margin-top: -1px;
   }


   .grid {
       display: grid;
       grid-template-columns: repeat(3, 1fr);
       gap: 28px;
       margin-top: 20px;
   }


   .grid-item {
       aspect-ratio: 1;
       background-color: var(--grid-background);
       border-radius: 4px;
       transition: background-color 0.3s ease;
   }


   /* edit panel styles */
   .edit-panel {
       position: fixed;
       top: 0;
       right: -320px;
       width: 320px;
       height: 100%;
       background-color: white;
       box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
       transition: right 0.3s ease-in-out;
       z-index: 1000;
       overflow: hidden;
   }


   .panel-content {
       position: absolute;
       top: 0;
       left: 0;
       width: 100%;
       height: 100%;
       transition: transform 0.3s ease-in-out;
       background: white;
       display: flex;
       flex-direction: column;
   }


   .panel-content.submenu {
       transform: translateX(100%);
   }


   .panel-content.submenu.open {
       transform: translateX(0);
   }


   .scroll-container {
       flex: 1;
       overflow-y: auto;
       padding-bottom: 20px;
   }


   .options-list {
       padding: 8px 0;
   }


   .option-item {
       padding: 16px 20px;
       cursor: pointer;
       transition: background-color 0.2s ease;
   }


   .option-item:hover {
       background-color: var(--background-color);
   }


   .option-name {
       font-size: 16px;
       color: var(--text-color);
       margin-bottom: 4px;
   }


   .option-description {
       font-size: 14px;
       color: var(--secondary-text);
   }


   .back-btn {
       background: none;
       border: none;
       cursor: pointer;
       color: var(--text-color);
       font-size: 24px;
       padding: 0 8px;
   }


   .edit-panel.open {
       right: 0;
   }


   .edit-panel-header {
       display: flex;
       justify-content: space-between;
       align-items: center;
       padding: 20px;
       border-bottom: 1px solid var(--border-color);
   }


   .close-btn {
       background: none;
       border: none;
       font-size: 20px;
       cursor: pointer;
       color: var(--secondary-text);
   }


   .close-btn:hover {
       color: var(--text-color);
   }


   .color-presets {
       padding: 16px;
       display: grid;
       grid-template-columns: repeat(2, 1fr);
       gap: 16px;
   }


   .color-preset {
       border: 1px solid var(--border-color);
       border-radius: 8px;
       padding: 16px;
       cursor: pointer;
       transition: transform 0.2s ease;
   }


   .color-preset:hover {
       transform: scale(1.02);
   }


   .preset-preview {
       height: 100px;
       border-radius: 4px;
       margin-bottom: 12px;
   }


   .preset-title {
       font-size: 14px;
       font-weight: 600;
       color: var(--text-color);
       margin-bottom: 4px;
   }


   .preset-desc {
       font-size: 12px;
       color: var(--secondary-text);
   }


   .section-header {
       padding: 20px 16px 0;
       border-top: 1px solid var(--border-color);
       margin-top: 16px;
   }


   .section-header h3 {
       color: var(--text-color);
       font-size: 16px;
       font-weight: 600;
   }


   .frame-presets {
       padding: 16px;
       display: grid;
       grid-template-columns: repeat(2, 1fr);
       gap: 16px;
   }


   .frame-option {
       border: 1px solid var(--border-color);
       border-radius: 8px;
       padding: 16px;
       cursor: pointer;
       transition: transform 0.2s ease;
   }


   .frame-option:hover {
       transform: scale(1.02);
   }


   .frame-preview {
       height: 100px;
       margin-bottom: 12px;
       background-color: var(--grid-background);
       display: flex;
       align-items: center;
       justify-content: center;
   }


   .frame-preview.circle {
       width: 80px;
       height: 80px;
       border-radius: 50%;
       margin: 10px auto;
   }


   .frame-preview.square {
       width: 80px;
       height: 80px;
       border-radius: 8px;
       margin: 10px auto;
   }


   /* previews for the color schemes */
   .preset-preview.minimal {
       background: linear-gradient(45deg, #ffffff 0%, #f5f5f5 100%);
   }


   .preset-preview.vibrant {
       background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 100%);
   }


   .preset-preview.professional {
       background: linear-gradient(45deg, #2193b0 0%, #6dd5ed 100%);
   }


   .preset-preview.space {
       background: linear-gradient(45deg, #231942 0%, #9f86c0 100%);
   }


   /* photo outline stuff */
   .profile-pic {
       width: 100px;
       height: 100px;
       object-fit: cover;
       display: block;
   }


   /* circle */
   .profile-pic.frame-circle {
       border-radius: 50%;
   }


   /* square (this has rounded corners) */
   .profile-pic.frame-square {
       border-radius: 12px;
   }


   .color-preset.custom-colors {
   grid-column: span 2;
   background: white;
}


.preset-preview.custom {
   height: auto;
   padding: 10px;
}


.control-group {
   margin-bottom: 12px;
}


.control-group label {
   display: block;
   font-size: 12px;
   color: var(--text-color);
   margin-bottom: 4px;
}


.control-group input[type="color"] {
   width: 100%;
   height: 30px;
   border: 1px solid var(--border-color);
   border-radius: 4px;
   padding: 2px;
   cursor: pointer;
}


   </style>
</body>
</html>

